--create table dbo.FileList
--(FullFilePath varchar(8000) not null,
--LastLoadDate datetime null,
--RowsLoaded int null,
--LoadFlag varchar(1)
--)

--insert into dbo.FileList
--(FullFilePath)
--values
--('F:\GIE\AGSI\SSO_11XNERGIE------1_https---agsi-gie-eu-api-data-11XNERGIE------1-DE_20211004121405.json'),
--('F:\GIE\AGSI\SSO_11XSWB-BREMEN--I_https---agsi-gie-eu-api-data-11XSWB-BREMEN--I-DE_20211004121440.json'),
--('F:\GIE\AGSI\SSO_11XSWHANNOVERAG3_https---agsi-gie-eu-api-data-11XSWHANNOVERAG3-DE_20211004121419.json'),
--('F:\GIE\AGSI\SSO_21X-BE-A-A0A0A-Y_https---agsi-gie-eu-api-data-21X-BE-A-A0A0A-Y-BE_20211004121233.json'),
--('F:\GIE\AGSI\SSO_21X-BG-A-A0A0A-C_https---agsi-gie-eu-api-data-21X-BG-A-A0A0A-C-BG_20211004121237.json'),
--('F:\GIE\AGSI\SSO_21X-DEPOGAZ-AGSI_https---agsi-gie-eu-api-data-21X-DEPOGAZ-AGSI-RO_20211004121719.json'),
--('F:\GIE\AGSI\SSO_21X-FR-B-A0A0A-J_https---agsi-gie-eu-api-data-21X-FR-B-A0A0A-J-FR_20211004121543.json'),
--('F:\GIE\AGSI\SSO_21X-SE-A-A0A0A-F_https---agsi-gie-eu-api-data-21X-SE-A-A0A0A-F-SE_20211004121733.json'),
--('F:\GIE\AGSI\SSO_21X000000001057C_https---agsi-gie-eu-api-data-21X000000001057C-NL_20211004121642.json'),
--('F:\GIE\AGSI\SSO_21X000000001072G_https---agsi-gie-eu-api-data-21X000000001072G-DE_20211004121426.json'),
--('F:\GIE\AGSI\SSO_21X000000001075A_https---agsi-gie-eu-api-data-21X000000001075A-NL_20211004121646.json'),
--('F:\GIE\AGSI\SSO_21X000000001083B_https---agsi-gie-eu-api-data-21X000000001083B-FR_20211004121525.json'),
--('F:\GIE\AGSI\SSO_21X0000000010849_https---agsi-gie-eu-api-data-21X0000000010849-DE_20211004121308.json'),
--('F:\GIE\AGSI\SSO_21X000000001090E_https---agsi-gie-eu-api-data-21X000000001090E-DE_20211004121329.json'),
--('F:\GIE\AGSI\SSO_21X000000001104T_https---agsi-gie-eu-api-data-21X000000001104T-DK_20211004121518.json'),
--('F:\GIE\AGSI\SSO_21X000000001120V_https---agsi-gie-eu-api-data-21X000000001120V-NL_20211004121653.json'),
--('F:\GIE\AGSI\SSO_21X000000001125L_https---agsi-gie-eu-api-data-21X000000001125L-DE_20211004121304.json'),
--('F:\GIE\AGSI\SSO_21X000000001127H_https---agsi-gie-eu-api-data-21X000000001127H-AT_20211004121229.json'),
--('F:\GIE\AGSI\SSO_21X000000001127H_https---agsi-gie-eu-api-data-21X000000001127H-DE_20211004121450.json'),
--('F:\GIE\AGSI\SSO_21X000000001138C_https---agsi-gie-eu-api-data-21X000000001138C-DE_20211004121509.json'),
--('F:\GIE\AGSI\SSO_21X000000001140P_https---agsi-gie-eu-api-data-21X000000001140P-DE_20211004121355.json'),
--('F:\GIE\AGSI\SSO_21X000000001160J_https---agsi-gie-eu-api-data-21X000000001160J-AT_20211004121212.json'),
--('F:\GIE\AGSI\SSO_21X000000001160J_https---agsi-gie-eu-api-data-21X000000001160J-DE_20211004121251.json'),
--('F:\GIE\AGSI\SSO_21X0000000011748_https---agsi-gie-eu-api-data-21X0000000011748-DE_20211004121409.json'),
--('F:\GIE\AGSI\SSO_21X0000000011756_https---agsi-gie-eu-api-data-21X0000000011756-DE_20211004121314.json'),
--('F:\GIE\AGSI\SSO_21X000000001250I_https---agsi-gie-eu-api-data-21X000000001250I-IT_20211004121634.json'),
--('F:\GIE\AGSI\SSO_21X000000001262B_https---agsi-gie-eu-api-data-21X000000001262B-DE_20211004121339.json'),
--('F:\GIE\AGSI\SSO_21X000000001300T_https---agsi-gie-eu-api-data-21X000000001300T-RO_20211004121714.json'),
--('F:\GIE\AGSI\SSO_21X000000001307F_https---agsi-gie-eu-api-data-21X000000001307F-DE_20211004121444.json'),
--('F:\GIE\AGSI\SSO_21X000000001310Q_https---agsi-gie-eu-api-data-21X000000001310Q-DE_20211004121447.json'),
--('F:\GIE\AGSI\SSO_21X0000000013279_https---agsi-gie-eu-api-data-21X0000000013279-UA_20211004121743.json'),
--('F:\GIE\AGSI\SSO_21X0000000013368_https---agsi-gie-eu-api-data-21X0000000013368-ES_20211004121522.json'),
--('F:\GIE\AGSI\SSO_21X0000000013627_https---agsi-gie-eu-api-data-21X0000000013627-PT_20211004121710.json'),
--('F:\GIE\AGSI\SSO_21X0000000013635_https---agsi-gie-eu-api-data-21X0000000013635-HU_20211004121613.json'),
--('F:\GIE\AGSI\SSO_21X0000000013643_https---agsi-gie-eu-api-data-21X0000000013643-HU_20211004121617.json'),
--('F:\GIE\AGSI\SSO_21X0000000013651_https---agsi-gie-eu-api-data-21X0000000013651-IT_20211004121626.json'),
--('F:\GIE\AGSI\SSO_21X000000001368W_https---agsi-gie-eu-api-data-21X000000001368W-DE_20211004121311.json'),
--('F:\GIE\AGSI\SSO_21X0000000013716_https---agsi-gie-eu-api-data-21X0000000013716-GB_20211004121606.json'),
--('F:\GIE\AGSI\SSO_21X0000000013732_https---agsi-gie-eu-api-data-21X0000000013732-NL_20211004121656.json'),
--('F:\GIE\AGSI\SSO_21X000000001379R_https---agsi-gie-eu-api-data-21X000000001379R-LV_20211004121638.json'),
--('F:\GIE\AGSI\SSO_21X0000000013805_https---agsi-gie-eu-api-data-21X0000000013805-DE_20211004121334.json'),
--('F:\GIE\AGSI\SSO_23X----100225-1C_https---agsi-gie-eu-api-data-23X----100225-1C-AT_20211004121225.json'),
--('F:\GIE\AGSI\SSO_23X--140207-SSE9_https---agsi-gie-eu-api-data-23X--140207-SSE9-GB_20211004121557.json'),
--('F:\GIE\AGSI\SSO_23X-EDFE-------W_https---agsi-gie-eu-api-data-23X-EDFE-------W-GB_20211004121547.json'),
--('F:\GIE\AGSI\SSO_23XSCOTTISHPOWEF_https---agsi-gie-eu-api-data-23XSCOTTISHPOWEF-GB_20211004121554.json'),
--('F:\GIE\AGSI\SSO_25X-GSALLC-----E_https---agsi-gie-eu-api-data-25X-GSALLC-----E-AT_20211004121218.json'),
--('F:\GIE\AGSI\SSO_25X-OMVGASSTORA5_https---agsi-gie-eu-api-data-25X-OMVGASSTORA5-AT_20211004121221.json'),
--('F:\GIE\AGSI\SSO_25X-OMVGASSTORA5_https---agsi-gie-eu-api-data-25X-OMVGASSTORA5-DE_20211004121416.json'),
--('F:\GIE\AGSI\SSO_27X-MORAVIAGS--E_https---agsi-gie-eu-api-data-27X-MORAVIAGS--E-CZ_20211004121247.json'),
--('F:\GIE\AGSI\SSO_27X-SPPSTORAGE-R_https---agsi-gie-eu-api-data-27X-SPPSTORAGE-R-CZ_20211004121248.json'),
--('F:\GIE\AGSI\SSO_27XG-MNDGS-CZ--R_https---agsi-gie-eu-api-data-27XG-MNDGS-CZ--R-CZ_20211004121245.json'),
--('F:\GIE\AGSI\SSO_27XG-RWE-GAS-STI_https---agsi-gie-eu-api-data-27XG-RWE-GAS-STI-CZ_20211004121242.json'),
--('F:\GIE\AGSI\SSO_31X-PSP-OSS-HR-D_https---agsi-gie-eu-api-data-31X-PSP-OSS-HR-D-HR_20211004121610.json'),
--('F:\GIE\AGSI\SSO_37X0000000000119_https---agsi-gie-eu-api-data-37X0000000000119-DE_20211004121412.json'),
--('F:\GIE\AGSI\SSO_37X0000000000151_https---agsi-gie-eu-api-data-37X0000000000151-DE_20211004121258.json'),
--('F:\GIE\AGSI\SSO_37X0000000000224_https---agsi-gie-eu-api-data-37X0000000000224-DE_20211004121302.json'),
--('F:\GIE\AGSI\SSO_37X000000000042Z_https---agsi-gie-eu-api-data-37X000000000042Z-DE_20211004121359.json'),
--('F:\GIE\AGSI\SSO_37X000000000051Y_https---agsi-gie-eu-api-data-37X000000000051Y-DE_20211004121422.json'),
--('F:\GIE\AGSI\SSO_42X-NAFTA-SK---U_https---agsi-gie-eu-api-data-42X-NAFTA-SK---U-SK_20211004121736.json'),
--('F:\GIE\AGSI\SSO_42X-POZAGAS-SK-V_https---agsi-gie-eu-api-data-42X-POZAGAS-SK-V-SK_20211004121740.json'),
--('F:\GIE\AGSI\SSO_47X0000000000584_https---agsi-gie-eu-api-data-47X0000000000584-IE_20211004121623.json'),
--('F:\GIE\AGSI\SSO_48XSTORENGYUK01P_https---agsi-gie-eu-api-data-48XSTORENGYUK01P-GB_20211004121603.json'),
--('F:\GIE\AGSI\SSO_53XPL000000OSMP5_https---agsi-gie-eu-api-data-53XPL000000OSMP5-PL_20211004121700.json'),
--('F:\GIE\AGSI\SSO_55XHUMBLYGROVE1H_https---agsi-gie-eu-api-data-55XHUMBLYGROVE1H-GB_20211004121550.json'),
--('F:\GIE\AGSI\SSO_59X4-IGSTORAGE-T_https---agsi-gie-eu-api-data-59X4-IGSTORAGE-T-IT_20211004121630.json'),
--('F:\GIE\AGSI\Storage Facility_16ZAS01--------8_https---agsi-gie-eu-api-data-16ZAS01--------8-PT-21X0000000013627_20211004121713.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000001L_https---agsi-gie-eu-api-data-21W000000000001L-NL-21X000000001075A_20211004121649.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000002J_https---agsi-gie-eu-api-data-21W000000000002J-NL-21X0000000013732_20211004121659.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000003H_https---agsi-gie-eu-api-data-21W000000000003H-DE-21X000000001262B_20211004121345.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000004F_https---agsi-gie-eu-api-data-21W000000000004F-DE-21X000000001262B_20211004121347.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000005D_https---agsi-gie-eu-api-data-21W000000000005D-DE-37X0000000000119_20211004121414.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000006B_https---agsi-gie-eu-api-data-21W000000000006B-NL-21X000000001057C_20211004121644.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000000087_https---agsi-gie-eu-api-data-21W0000000000087-NL-21X000000001120V_20211004121655.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000012G_https---agsi-gie-eu-api-data-21W000000000012G-DE-21X0000000010849_20211004121309.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000013E_https---agsi-gie-eu-api-data-21W000000000013E-DE-21X000000001125L_20211004121306.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000015A_https---agsi-gie-eu-api-data-21W000000000015A-NL-21X000000001075A_20211004121652.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000000168_https---agsi-gie-eu-api-data-21W0000000000168-DE-21X000000001127H_20211004121506.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000000184_https---agsi-gie-eu-api-data-21W0000000000184-DE-37X0000000000151_20211004121300.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000000192_https---agsi-gie-eu-api-data-21W0000000000192-DE-21X0000000011748_20211004121411.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000020H_https---agsi-gie-eu-api-data-21W000000000020H-DE-21X0000000013805_20211004121338.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000023B_https---agsi-gie-eu-api-data-21W000000000023B-DE-21X000000001138C_20211004121515.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000000265_https---agsi-gie-eu-api-data-21W0000000000265-DE-21X000000001262B_20211004121349.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000000273_https---agsi-gie-eu-api-data-21W0000000000273-DE-21X000000001072G_20211004121434.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000030E_https---agsi-gie-eu-api-data-21W000000000030E-DE-21X000000001307F_20211004121446.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000031C_https---agsi-gie-eu-api-data-21W000000000031C-BG-21X-BG-A-A0A0A-C_20211004121241.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000000435_https---agsi-gie-eu-api-data-21W0000000000435-SE-21X-SE-A-A0A0A-F_20211004121735.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000047Y_https---agsi-gie-eu-api-data-21W000000000047Y-SK-42X-POZAGAS-SK-V_20211004121742.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000048W_https---agsi-gie-eu-api-data-21W000000000048W-DE-21X0000000011756_20211004121327.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000000508_https---agsi-gie-eu-api-data-21W0000000000508-DE-21X0000000011756_20211004121317.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000000516_https---agsi-gie-eu-api-data-21W0000000000516-DE-21X000000001262B_20211004121352.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000000524_https---agsi-gie-eu-api-data-21W0000000000524-DE-21X000000001262B_20211004121341.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000000532_https---agsi-gie-eu-api-data-21W0000000000532-DE-21X000000001262B_20211004121343.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000000540_https---agsi-gie-eu-api-data-21W0000000000540-DE-21X000000001090E_20211004121333.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000055Z_https---agsi-gie-eu-api-data-21W000000000055Z-DE-21X000000001090E_20211004121331.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000056X_https---agsi-gie-eu-api-data-21W000000000056X-DE-25X-OMVGASSTORA5_20211004121417.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000057V_https---agsi-gie-eu-api-data-21W000000000057V-AT-21X000000001127H_20211004121231.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000059R_https---agsi-gie-eu-api-data-21W000000000059R-DE-21X000000001127H_20211004121503.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000000605_https---agsi-gie-eu-api-data-21W0000000000605-DE-21X000000001127H_20211004121454.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000000613_https---agsi-gie-eu-api-data-21W0000000000613-DE-21X000000001127H_20211004121452.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000000621_https---agsi-gie-eu-api-data-21W0000000000621-DE-37X000000000042Z_20211004121402.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000064Y_https---agsi-gie-eu-api-data-21W000000000064Y-DE-37X000000000042Z_20211004121400.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000065W_https---agsi-gie-eu-api-data-21W000000000065W-DE-21X000000001127H_20211004121459.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000066U_https---agsi-gie-eu-api-data-21W000000000066U-DE-21X000000001127H_20211004121457.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000067S_https---agsi-gie-eu-api-data-21W000000000067S-DE-21X000000001127H_20211004121508.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000074V_https---agsi-gie-eu-api-data-21W000000000074V-CZ-27X-SPPSTORAGE-R_20211004121250.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000075T_https---agsi-gie-eu-api-data-21W000000000075T-CZ-27XG-MNDGS-CZ--R_20211004121246.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000077P_https---agsi-gie-eu-api-data-21W000000000077P-HR-31X-PSP-OSS-HR-D_20211004121612.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000078N_https---agsi-gie-eu-api-data-21W000000000078N-AT-21X000000001160J_20211004121214.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000083U_https---agsi-gie-eu-api-data-21W000000000083U-DE-21X000000001127H_20211004121501.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000085Q_https---agsi-gie-eu-api-data-21W000000000085Q-DE-21X000000001310Q_20211004121449.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000086O_https---agsi-gie-eu-api-data-21W000000000086O-HU-21X0000000013643_20211004121619.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000088K_https---agsi-gie-eu-api-data-21W000000000088K-SK-42X-NAFTA-SK---U_20211004121738.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000089I_https---agsi-gie-eu-api-data-21W000000000089I-DE-21X000000001072G_20211004121436.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000090X_https---agsi-gie-eu-api-data-21W000000000090X-DE-11XSWB-BREMEN--I_20211004121442.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000090X_https---agsi-gie-eu-api-data-21W000000000090X-DE-21X000000001072G_20211004121432.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000091V_https---agsi-gie-eu-api-data-21W000000000091V-DE-21X000000001072G_20211004121428.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000092T_https---agsi-gie-eu-api-data-21W000000000092T-DE-21X000000001072G_20211004121430.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000093R_https---agsi-gie-eu-api-data-21W000000000093R-DE-21X000000001072G_20211004121439.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000097J_https---agsi-gie-eu-api-data-21W000000000097J-DE-21X000000001140P_20211004121357.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000101H_https---agsi-gie-eu-api-data-21W000000000101H-GB-48XSTORENGYUK01P_20211004121605.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000102F_https---agsi-gie-eu-api-data-21W000000000102F-CZ-27X-MORAVIAGS--E_20211004121247.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000103D_https---agsi-gie-eu-api-data-21W000000000103D-DE-21X0000000011756_20211004121324.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000104B_https---agsi-gie-eu-api-data-21W000000000104B-DE-21X0000000011756_20211004121322.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000001059_https---agsi-gie-eu-api-data-21W0000000001059-DE-21X0000000011756_20211004121321.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000001067_https---agsi-gie-eu-api-data-21W0000000001067-DE-21X0000000011756_20211004121326.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000001075_https---agsi-gie-eu-api-data-21W0000000001075-DE-21X0000000011756_20211004121316.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000001083_https---agsi-gie-eu-api-data-21W0000000001083-DE-37X0000000000224_20211004121303.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000112C_https---agsi-gie-eu-api-data-21W000000000112C-GB-21X0000000013716_20211004121608.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000113A_https---agsi-gie-eu-api-data-21W000000000113A-LV-21X000000001379R_20211004121640.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000001148_https---agsi-gie-eu-api-data-21W0000000001148-DE-21X000000001160J_20211004121253.json'),
--('F:\GIE\AGSI\Storage Facility_21W0000000001164_https---agsi-gie-eu-api-data-21W0000000001164-DE-37X000000000051Y_20211004121425.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000120D_https---agsi-gie-eu-api-data-21W000000000120D-DE-21X000000001138C_20211004121511.json'),
--('F:\GIE\AGSI\Storage Facility_21W000000000128Y_https---agsi-gie-eu-api-data-21W000000000128Y-DE-21X000000001138C_20211004121513.json'),
--('F:\GIE\AGSI\Storage Facility_21Z000000000102A_https---agsi-gie-eu-api-data-21Z000000000102A-BE-21X-BE-A-A0A0A-Y_20211004121235.json'),
--('F:\GIE\AGSI\Storage Facility_21Z000000000227R_https---agsi-gie-eu-api-data-21Z000000000227R-GB-23X-EDFE-------W_20211004121549.json'),
--('F:\GIE\AGSI\Storage Facility_21Z000000000229N_https---agsi-gie-eu-api-data-21Z000000000229N-GB-23XSCOTTISHPOWEF_20211004121556.json'),
--('F:\GIE\AGSI\Storage Facility_21Z000000000271O_https---agsi-gie-eu-api-data-21Z000000000271O-DE-21X000000001160J_20211004121255.json'),
--('F:\GIE\AGSI\Storage Facility_21Z000000000309P_https---agsi-gie-eu-api-data-21Z000000000309P-RO-21X000000001300T_20211004121717.json'),
--('F:\GIE\AGSI\Storage Facility_21Z0000000003103_https---agsi-gie-eu-api-data-21Z0000000003103-RO-21X-DEPOGAZ-AGSI_20211004121732.json'),
--('F:\GIE\AGSI\Storage Facility_21Z0000000003111_https---agsi-gie-eu-api-data-21Z0000000003111-RO-21X-DEPOGAZ-AGSI_20211004121721.json'),
--('F:\GIE\AGSI\Storage Facility_21Z000000000313Y_https---agsi-gie-eu-api-data-21Z000000000313Y-RO-21X-DEPOGAZ-AGSI_20211004121723.json'),
--('F:\GIE\AGSI\Storage Facility_21Z000000000314W_https---agsi-gie-eu-api-data-21Z000000000314W-RO-21X-DEPOGAZ-AGSI_20211004121729.json'),
--('F:\GIE\AGSI\Storage Facility_21Z000000000315U_https---agsi-gie-eu-api-data-21Z000000000315U-RO-21X-DEPOGAZ-AGSI_20211004121727.json'),
--('F:\GIE\AGSI\Storage Facility_21Z000000000316S_https---agsi-gie-eu-api-data-21Z000000000316S-RO-21X-DEPOGAZ-AGSI_20211004121725.json'),
--('F:\GIE\AGSI\Storage Facility_21Z000000000321Z_https---agsi-gie-eu-api-data-21Z000000000321Z-DE-11XNERGIE------1_20211004121407.json'),
--('F:\GIE\AGSI\Storage Facility_21Z000000000381H_https---agsi-gie-eu-api-data-21Z000000000381H-PL-53XPL000000OSMP5_20211004121704.json'),
--('F:\GIE\AGSI\Storage Facility_21Z0000000004002_https---agsi-gie-eu-api-data-21Z0000000004002-DE-11XSWHANNOVERAG3_20211004121421.json'),
--('F:\GIE\AGSI\Storage Facility_25W-SPHAID-GAZ-M_https---agsi-gie-eu-api-data-25W-SPHAID-GAZ-M-AT-25X-GSALLC-----E_20211004121220.json'),
--('F:\GIE\AGSI\Storage Facility_47W000000000245J_https---agsi-gie-eu-api-data-47W000000000245J-IE-47X0000000000584_20211004121625.json'),
--('F:\GIE\AGSI\Storage Facility_55WALDBOROUGH00H_https---agsi-gie-eu-api-data-55WALDBOROUGH00H-GB-23X--140207-SSE9_20211004121559.json'),
--('F:\GIE\AGSI\Storage Facility_55WATWICK-SSE00J_https---agsi-gie-eu-api-data-55WATWICK-SSE00J-GB-23X--140207-SSE9_20211004121602.json'),
--('F:\GIE\AGSI\Storage Facility_55WHUMBLY1GROVER_https---agsi-gie-eu-api-data-55WHUMBLY1GROVER-GB-55XHUMBLYGROVE1H_20211004121552.json'),
--('F:\GIE\AGSI\Storage Facility_56W-UGS-BILCHE-4_https---agsi-gie-eu-api-data-56W-UGS-BILCHE-4-UA-21X0000000013279_20211004121746.json'),
--('F:\GIE\AGSI\Storage Facility_56W-UGS-BOHORO-4_https---agsi-gie-eu-api-data-56W-UGS-BOHORO-4-UA-21X0000000013279_20211004121748.json'),
--('F:\GIE\AGSI\Storage Facility_56W-UGS-CHERVO-W_https---agsi-gie-eu-api-data-56W-UGS-CHERVO-W-UA-21X0000000013279_20211004121751.json'),
--('F:\GIE\AGSI\Storage Facility_56W-UGS-DASHAV-S_https---agsi-gie-eu-api-data-56W-UGS-DASHAV-S-UA-21X0000000013279_20211004121753.json'),
--('F:\GIE\AGSI\Storage Facility_56W-UGS-KEHYCH-X_https---agsi-gie-eu-api-data-56W-UGS-KEHYCH-X-UA-21X0000000013279_20211004121755.json'),
--('F:\GIE\AGSI\Storage Facility_56W-UGS-KRPOPY-Q_https---agsi-gie-eu-api-data-56W-UGS-KRPOPY-Q-UA-21X0000000013279_20211004121758.json'),
--('F:\GIE\AGSI\Storage Facility_56W-UGS-OLYSHI-5_https---agsi-gie-eu-api-data-56W-UGS-OLYSHI-5-UA-21X0000000013279_20211004121800.json'),
--('F:\GIE\AGSI\Storage Facility_56W-UGS-OPARSK-2_https---agsi-gie-eu-api-data-56W-UGS-OPARSK-2-UA-21X0000000013279_20211004121802.json'),
--('F:\GIE\AGSI\Storage Facility_56W-UGS-PROLET-T_https---agsi-gie-eu-api-data-56W-UGS-PROLET-T-UA-21X0000000013279_20211004121805.json'),
--('F:\GIE\AGSI\Storage Facility_56W-UGS-SOLOKH-4_https---agsi-gie-eu-api-data-56W-UGS-SOLOKH-4-UA-21X0000000013279_20211004121807.json'),
--('F:\GIE\AGSI\Storage Facility_56W-UGS-UHERSK-N_https---agsi-gie-eu-api-data-56W-UGS-UHERSK-N-UA-21X0000000013279_20211004121809.json'),
--('F:\GIE\AGSI\Storage Facility_56W-UGS-VERHUN-S_https---agsi-gie-eu-api-data-56W-UGS-VERHUN-S-UA-21X0000000013279_20211004121812.json'),
--('F:\GIE\AGSI\Storage Facility_59W-IGSTORAGE-0Q_https---agsi-gie-eu-api-data-59W-IGSTORAGE-0Q-IT-59X4-IGSTORAGE-T_20211004121632.json'),
--('F:\GIE\AGSI\Storage Facility_PRIOR_EWE_000001_https---agsi-gie-eu-api-data-PRIOR_EWE_000001-DE-21X0000000011756_20211004121319.json'),
--('F:\GIE\AGSI\Storage Group_21W000000000032A_https---agsi-gie-eu-api-data-21W000000000032A-ES-21X0000000013368_20211004121524.json'),
--('F:\GIE\AGSI\Storage Group_21W0000000000427_https---agsi-gie-eu-api-data-21W0000000000427-DE-21X000000001138C_20211004121516.json'),
--('F:\GIE\AGSI\Storage Group_21W000000000068Q_https---agsi-gie-eu-api-data-21W000000000068Q-FR-21X-FR-B-A0A0A-J_20211004121545.json'),
--('F:\GIE\AGSI\Storage Group_21W000000000069O_https---agsi-gie-eu-api-data-21W000000000069O-FR-21X000000001083B_20211004121542.json'),
--('F:\GIE\AGSI\Storage Group_21W0000000000702_https---agsi-gie-eu-api-data-21W0000000000702-FR-21X000000001083B_20211004121533.json'),
--('F:\GIE\AGSI\Storage Group_21W0000000000710_https---agsi-gie-eu-api-data-21W0000000000710-FR-21X000000001083B_20211004121530.json'),
--('F:\GIE\AGSI\Storage Group_21W000000000072Z_https---agsi-gie-eu-api-data-21W000000000072Z-FR-21X000000001083B_20211004121535.json'),
--('F:\GIE\AGSI\Storage Group_21W000000000073X_https---agsi-gie-eu-api-data-21W000000000073X-FR-21X000000001083B_20211004121539.json'),
--('F:\GIE\AGSI\Storage Group_21W000000000076R_https---agsi-gie-eu-api-data-21W000000000076R-CZ-27XG-RWE-GAS-STI_20211004121244.json'),
--('F:\GIE\AGSI\Storage Group_21W000000000079L_https---agsi-gie-eu-api-data-21W000000000079L-AT-23X----100225-1C_20211004121228.json'),
--('F:\GIE\AGSI\Storage Group_21W000000000081Y_https---agsi-gie-eu-api-data-21W000000000081Y-AT-25X-OMVGASSTORA5_20211004121224.json'),
--('F:\GIE\AGSI\Storage Group_21W000000000084S_https---agsi-gie-eu-api-data-21W000000000084S-FR-21X000000001083B_20211004121528.json'),
--('F:\GIE\AGSI\Storage Group_21W000000000087M_https---agsi-gie-eu-api-data-21W000000000087M-HU-21X0000000013635_20211004121615.json'),
--('F:\GIE\AGSI\Storage Group_21W000000000095N_https---agsi-gie-eu-api-data-21W000000000095N-IT-21X0000000013651_20211004121628.json'),
--('F:\GIE\AGSI\Storage Group_21W000000000100J_https---agsi-gie-eu-api-data-21W000000000100J-DE-21X000000001368W_20211004121312.json'),
--('F:\GIE\AGSI\Storage Group_21W000000000121B_https---agsi-gie-eu-api-data-21W000000000121B-DE-21X000000001262B_20211004121354.json'),
--('F:\GIE\AGSI\Storage Group_21W0000000001261_https---agsi-gie-eu-api-data-21W0000000001261-DE-21X000000001160J_20211004121256.json'),
--('F:\GIE\AGSI\Storage Group_21Z000000000274I_https---agsi-gie-eu-api-data-21Z000000000274I-IT-21X000000001250I_20211004121637.json'),
--('F:\GIE\AGSI\Storage Group_21Z000000000382F_https---agsi-gie-eu-api-data-21Z000000000382F-PL-53XPL000000OSMP5_20211004121709.json'),
--('F:\GIE\AGSI\Storage Group_21Z000000000383D_https---agsi-gie-eu-api-data-21Z000000000383D-PL-53XPL000000OSMP5_20211004121707.json'),
--('F:\GIE\AGSI\Storage Group_37Y000000000386Q_https---agsi-gie-eu-api-data-37Y000000000386Q-DE-37X000000000042Z_20211004121404.json'),
--('F:\GIE\AGSI\Storage Group_45W000000000112V_https---agsi-gie-eu-api-data-45W000000000112V-DK-21X000000001104T_20211004121520.json'),
--('F:\GIE\AGSI\Storage Group_63W197197128864M_https---agsi-gie-eu-api-data-63W197197128864M-FR-21X000000001083B_20211004121537.json'),
--('F:\GIE\AGSI\Storage Group_PRIOR_OSM_000001_https---agsi-gie-eu-api-data-PRIOR_OSM_000001-PL-53XPL000000OSMP5_20211004121702.json')


--select * from dbo.filelist

--update dbo.filelist set loadflag = 'Y'

create procedure ApplyProcToFileList @ProcName varchar(50) as
BEGIN

DECLARE @FullFilePath varchar(8000)
DECLARE @SQL varchar(8000)

DECLARE file_cursor CURSOR
	FOR SELECT FullFilePath FROM dbo.FileList WHERE LoadFlag = 'Y'
OPEN File_Cursor
FETCH NEXT FROM File_Cursor
INTO @FullFilePath

WHILE @@FETCH_STATUS = 0
BEGIN
	SET @SQL = 'EXEC ' + @ProcName + ' ''' + @FullFilePath + ''''
	EXEC(@SQL)
	UPDATE dbo.FileList 
	SET LastLoadDate = GETDATE(),
		RowsLoaded = @@ROWCOUNT,
		LoadFlag = 'N'
	WHERE FullFilePath = @FullFilePath

	FETCH NEXT FROM File_Cursor
	INTO @FullFilePath
END

CLOSE File_Cursor
DEALLOCATE File_Cursor

END