
/******************************
** Name:  vw_DIWellLocationSatStageData
** Desc:
** Auth:  Aaron Vogt
** Date:  10/17/2019
**************************
** Change History
**************************
** PR   Date         Author    Description 
** --   ----------   -------   ------------------------------------
** 1    10/17/2019   Aaron Vogt     Object creation
*******************************/
CREATE VIEW [DW].[vw_DIWellLocationSatStageData]
	AS 
SELECT
	*
FROM
(SELECT 
	HASHBYTES('SHA2_256', LEFT(wr.API14, 14)) AS WellHashKey,
	'DI Well Rollups' AS [RecordSource],
	CONVERT(DATETIME2(7), COALESCE(wr.UpdatedDate, wr.CreatedDate, wo.UpdatedDate, wo.CreatedDate)) AS [LoadDate],
	CONVERT(DATETIME2(7), NULL) AS [LoadEndDate],	
	CONVERT(DECIMAL(13, 9), wr.SurfaceHoleLongitudeWGS84) AS SURFACE_LONGITUDE,
	CONVERT(DECIMAL(13, 9), wr.SurfaceHoleLatitudeWGS84) AS SURFACE_LATITUDE,
	CONVERT(DECIMAL(13, 9), wr.BottomHoleLongitudeWGS84) AS BH_LONGITUDE,
	CONVERT(DECIMAL(13, 9), wr.BottomHoleLatitudeWGS84) AS BH_LATITUDE,
	CASE 
		WHEN LTRIM(RTRIM(wo.TownshipDirection)) = '' OR wo.TownshipDirection IS NULL THEN RIGHT(wr.Township, 1)
		ELSE wo.TownshipDirection
	END AS Surface_TOWNSHIP_DIRECTION,
	CASE
		WHEN RTRIM(LTRIM(wr.Township)) = '' THEN NULL
		ELSE CONVERT(DECIMAL(6, 1), REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(wr.Township, 'N', ''), 'S', ''), 'E', ''), 'W', ''), 'H', ''))
	END AS Surface_TOWNSHIP_NUMBER,
	CASE
		WHEN LTRIM(RTRIM(wo.RangeDirection)) = '' OR wo.RangeDirection IS NULL THEN RIGHT(wr.Range, 1)
		ELSE wo.RangeDirection
	END AS Surface_RANGE_DIRECTION,
	CASE
		WHEN RTRIM(LTRIM(wr.Range)) = '' THEN NULL
		ELSE CONVERT(DECIMAL(5, 1), REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(wr.Range, 'N', ''), 'S', ''), 'E', ''), 'W', ''), 'H', ''))
	END AS Surface_RANGE_NUMBER,
	CASE
		WHEN RTRIM(LTRIM(wr.Section)) = '' THEN NULL
		ELSE wr.Section
	END AS Surface_SECTION_NUMBER,
	NULL AS Surface_SECTION_TYPE,
	NULL AS Surface_SPOT,
	NULL AS Surface_MERIDIAN_NAME,
	wo.Remark AS Surface_REMARK,
	NULL AS Surface_FOOTAGE_NORTH_SOUTH,
	NULL AS Surface_FOOTAGE_NORTH_SOUTH_START_LINE,
	NULL AS Surface_FOOTAGE_EAST_WEST,
	NULL AS Surface_FOOTAGE_EAST_WEST_START_LINE,
	NULL AS Surface_FOOTAGE_REFERENCE_NAME,
	NULL AS Surface_OFFSHORE_BLOCK_ADDITION,
	NULL AS Surface_OFFSHORE_BLOCK_NUMBER,
	NULL AS Surface_OFFSHORE_BLOCK_MODIFIER,
	NULL AS Surface_OFFSHORE_OCS_NUMBER,
	NULL AS Surface_OFFSHORE_AREA_CODE,
	NULL AS Surface_OFFSHORE_UTM_QUADRANT,
	NULL AS Surface_OFFSHORE_GOVERNING_AGENCY,
	NULL AS Surface_OFFSHORE_WATER_BOTTOM_ZONE_NAME,
	NULL AS Surface_OFFSHORE_REMARK,
	NULL AS Surface_OFFSHORE_FOOTAGE_NORTH_SOUTH,
	NULL AS Surface_OFFSHORE_FOOTAGE_NORTH_SOUTH_START_LINE,
	NULL AS Surface_OFFSHORE_FOOTAGE_EAST_WEST,
	NULL AS Surface_OFFSHORE_FOOTAGE_EAST_WEST_START_LINE,
	NULL AS Surface_OFFSHORE_FOOTAGE_REFERENCE_NAME,
	NULL AS Surface_TEXAS_DISTRICT_NAME,
	NULL AS Surface_TEXAS_BLOCK_NUMBER,
	NULL AS Surface_TEXAS_BLOCK_FRACTION,
	NULL AS Surface_TEXAS_LEAGUE,
	NULL AS Surface_TEXAS_LOT,
	NULL AS Surface_TEXAS_TOWNSHIP_DIRECTION,
	NULL AS Surface_TEXAS_TOWNSHIP_NUMBER,
	NULL AS Surface_TEXAS_SECTION_NUMBER,
	NULL AS Surface_TEXAS_SECTION_FRACTION,
	NULL AS Surface_TEXAS_LABOR,
	NULL AS Surface_TEXAS_SURVEY,
	NULL AS Surface_TEXAS_ABSTRACT,
	NULL AS Surface_TEXAS_SPOT,
	NULL AS Surface_TEXAS_REMARK,
	NULL AS Surface_TEXAS_FOOTAGE_NORTH_SOUTH,
	NULL AS Surface_TEXAS_FOOTAGE_NORTH_SOUTH_START_LINE,
	NULL AS Surface_TEXAS_FOOTAGE_EAST_WEST,
	NULL AS Surface_TEXAS_FOOTAGE_EAST_WEST_START_LINE,
	NULL AS Surface_TEXAS_FOOTAGE_REFERENCE_NAME,
	NULL AS Surface_CARTER_TOWNSHIP_DIRECTION,
	NULL AS Surface_CARTER_TOWNSHIP_NAME,
	NULL AS Surface_CARTER_RANGE_DIRECTION,
	NULL AS Surface_CARTER_RANGE_NUMBER,
	NULL AS Surface_CARTER_SECTION,
	NULL AS Surface_CARTER_SPOT,
	NULL AS Surface_CARTER_QUADRANGLE_MINUTES,
	NULL AS Surface_CARTER_QUADRANGLE_NAME,
	NULL AS Surface_CARTER_REMARK,
	NULL AS Surface_CARTER_FOOTAGE_NORTH_SOUTH,
	NULL AS Surface_CARTER_FOOTAGE_NORTH_SOUTH_START_LINE,
	NULL AS Surface_CARTER_FOOTAGE_EAST_WEST,
	NULL AS Surface_CARTER_FOOTAGE_EAST_WEST_START_LINE,
	NULL AS Surface_CARTER_FOOTAGE_REFERENCE_NAME,
	NULL AS Surface_OHIO_LOT_CODE,
	NULL AS Surface_OHIO_SECTION_CODE,
	NULL AS Surface_OHIO_TOWNSHIP_NAME,
	NULL AS Surface_OHIO_MERIDIAN_NAME,
	NULL AS Surface_OHIO_SPOT,
	NULL AS Surface_OHIO_QUADRANGLE_NAME,
	NULL AS Surface_OHIO_QUADRANGLE_MINUTES,
	NULL AS Surface_OHIO_REMARK,
	NULL AS Surface_OHIO_FOOTAGE_NORTH_SOUTH,
	NULL AS Surface_OHIO_FOOTAGE_NORTH_SOUTH_START_LINE,
	NULL AS Surface_OHIO_FOOTAGE_EAST_WEST,
	NULL AS Surface_OHIO_FOOTAGE_EAST_WEST_START_LINE,
	NULL AS Surface_OHIO_FOOTAGE_REFERENCE_NAME,
	NULL AS Surface_NE_REFERENCE_LATITUDE,
	NULL AS Surface_NE_REFERENCE_LONGITUDE,
	NULL AS Surface_NE_TOWNSHIP_NAME,
	NULL AS Surface_NE_LOT_CODE,
	NULL AS Surface_NE_DISTRICT,
	NULL AS Surface_NE_QUADRANGLE_MINUTES,
	NULL AS Surface_NE_QUADRANGLE_NAME,
	NULL AS Surface_NE_QUADRANGLE_SECTION,
	NULL AS Surface_NE_REMARK,
	NULL AS Surface_NE_FOOTAGE_NORTH_SOUTH,
	NULL AS Surface_NE_FOOTAGE_NORTH_SOUTH_START_LINE,
	NULL AS Surface_NE_FOOTAGE_EAST_WEST,
	NULL AS Surface_NE_FOOTAGE_EAST_WEST_START_LINE,
	NULL AS Surface_NE_FOOTAGE_REFERENCE_NAME,
	NULL AS Surface_DLS_LOCATION_TYPE,
	NULL AS Surface_DLS_EVENT_SEQUENCE,
	NULL AS Surface_DLS_LEGAL_SUBDIVISION,
	NULL AS Surface_DLS_LOC_EXCEPTION,
	NULL AS Surface_DLS_MERIDIAN,
	NULL AS Surface_DLS_MERIDIAN_DIRECTION,
	NULL AS Surface_DLS_RANGE,
	NULL AS Surface_DLS_RANGE_MODIFIER,
	NULL AS Surface_DLS_SECTION,
	NULL AS Surface_DLS_TOWNSHIP,
	NULL AS Surface_DLS_TOWNSHIP_MODIFIER,
	NULL AS Surface_DLS_REMARK,
	NULL AS Surface_DLS_SOURCE,
	NULL AS Surface_FPS_LOCATION_TYPE,
	NULL AS Surface_FPS_EXCEPTION,
	NULL AS Surface_FPS_GRID,
	NULL AS Surface_FPS_REMARK,
	NULL AS Surface_FPS_SECTION,
	NULL AS Surface_FPS_SOURCE,
	NULL AS Surface_FPS_UNIT,
	NULL AS Surface_NTS_LOCATION_TYPE,
	NULL AS Surface_NTS_BLOCK,
	NULL AS Surface_NTS_EVENT_SEQUENCE,
	NULL AS Surface_NTS_LETTER_QUADRANGLE,
	NULL AS Surface_NTS_LOC_EXCEPTION,
	NULL AS Surface_NTS_PRIMARY_QUADRANGLE,
	NULL AS Surface_NTS_QUARTER_UNIT,
	NULL AS Surface_NTS_REMARK,
	NULL AS Surface_NTS_SIXTEENTH,
	NULL AS Surface_NTS_SOURCE,
	NULL AS Surface_NTS_UNIT,
	NULL AS BH_TOWNSHIP_DIRECTION,
	NULL AS BH_TOWNSHIP_NUMBER,
	NULL AS BH_RANGE_DIRECTION,
	NULL AS BH_RANGE_NUMBER,
	NULL AS BH_SECTION_NUMBER,
	NULL AS BH_SECTION_TYPE,
	NULL AS BH_SPOT,
	NULL AS BH_MERIDIAN_NAME,
	NULL AS BH_REMARK,
	NULL AS BH_FOOTAGE_NORTH_SOUTH,
	NULL AS BH_FOOTAGE_NORTH_SOUTH_START_LINE,
	NULL AS BH_FOOTAGE_EAST_WEST,
	NULL AS BH_FOOTAGE_EAST_WEST_START_LINE,
	NULL AS BH_FOOTAGE_REFERENCE_NAME,
	NULL AS BH_OFFSHORE_BLOCK_ADDITION,
	NULL AS BH_OFFSHORE_BLOCK_NUMBER,
	NULL AS BH_OFFSHORE_BLOCK_MODIFIER,
	NULL AS BH_OFFSHORE_OCS_NUMBER,
	NULL AS BH_OFFSHORE_AREA_CODE,
	NULL AS BH_OFFSHORE_UTM_QUADRANT,
	NULL AS BH_OFFSHORE_GOVERNING_AGENCY,
	NULL AS BH_OFFSHORE_WATER_BOTTOM_ZONE_NAME,
	NULL AS BH_OFFSHORE_REMARK,
	NULL AS BH_OFFSHORE_FOOTAGE_NORTH_SOUTH,
	NULL AS BH_OFFSHORE_FOOTAGE_NORTH_SOUTH_START_LINE,
	NULL AS BH_OFFSHORE_FOOTAGE_EAST_WEST,
	NULL AS BH_OFFSHORE_FOOTAGE_EAST_WEST_START_LINE,
	NULL AS BH_OFFSHORE_FOOTAGE_REFERENCE_NAME,
	NULL AS BH_TEXAS_DISTRICT_NAME,
	NULL AS BH_TEXAS_BLOCK_NUMBER,
	NULL AS BH_TEXAS_BLOCK_FRACTION,
	NULL AS BH_TEXAS_LEAGUE,
	NULL AS BH_TEXAS_LOT,
	NULL AS BH_TEXAS_TOWNSHIP_DIRECTION,
	NULL AS BH_TEXAS_TOWNSHIP_NUMBER,
	NULL AS BH_TEXAS_SECTION_NUMBER,
	NULL AS BH_TEXAS_SECTION_FRACTION,
	NULL AS BH_TEXAS_LABOR,
	NULL AS BH_TEXAS_SURVEY,
	NULL AS BH_TEXAS_ABSTRACT,
	NULL AS BH_TEXAS_SPOT,
	NULL AS BH_TEXAS_REMARK,
	NULL AS BH_TEXAS_FOOTAGE_NORTH_SOUTH,
	NULL AS BH_TEXAS_FOOTAGE_NORTH_SOUTH_START_LINE,
	NULL AS BH_TEXAS_FOOTAGE_EAST_WEST,
	NULL AS BH_TEXAS_FOOTAGE_EAST_WEST_START_LINE,
	NULL AS BH_TEXAS_FOOTAGE_REFERENCE_NAME,
	NULL AS BH_CARTER_TOWNSHIP_DIRECTION,
	NULL AS BH_CARTER_TOWNSHIP_NAME,
	NULL AS BH_CARTER_RANGE_DIRECTION,
	NULL AS BH_CARTER_RANGE_NUMBER,
	NULL AS BH_CARTER_SECTION,
	NULL AS BH_CARTER_SPOT,
	NULL AS BH_CARTER_QUADRANGLE_MINUTES,
	NULL AS BH_CARTER_QUADRANGLE_NAME,
	NULL AS BH_CARTER_REMARK,
	NULL AS BH_CARTER_FOOTAGE_NORTH_SOUTH,
	NULL AS BH_CARTER_FOOTAGE_NORTH_SOUTH_START_LINE,
	NULL AS BH_CARTER_FOOTAGE_EAST_WEST,
	NULL AS BH_CARTER_FOOTAGE_EAST_WEST_START_LINE,
	NULL AS BH_CARTER_FOOTAGE_REFERENCE_NAME,
	NULL AS BH_OHIO_LOT_CODE,
	NULL AS BH_OHIO_SECTION_CODE,
	NULL AS BH_OHIO_TOWNSHIP_NAME,
	NULL AS BH_OHIO_MERIDIAN_NAME,
	NULL AS BH_OHIO_SPOT,
	NULL AS BH_OHIO_QUADRANGLE_NAME,
	NULL AS BH_OHIO_QUADRANGLE_MINUTES,
	NULL AS BH_OHIO_REMARK,
	NULL AS BH_OHIO_FOOTAGE_NORTH_SOUTH,
	NULL AS BH_OHIO_FOOTAGE_NORTH_SOUTH_START_LINE,
	NULL AS BH_OHIO_FOOTAGE_EAST_WEST,
	NULL AS BH_OHIO_FOOTAGE_EAST_WEST_START_LINE,
	NULL AS BH_OHIO_FOOTAGE_REFERENCE_NAME,
	NULL AS BH_NE_REFERENCE_LATITUDE,
	NULL AS BH_NE_REFERENCE_LONGITUDE,
	NULL AS BH_NE_TOWNSHIP_NAME,
	NULL AS BH_NE_LOT_CODE,
	NULL AS BH_NE_DISTRICT,
	NULL AS BH_NE_QUADRANGLE_MINUTES,
	NULL AS BH_NE_QUADRANGLE_NAME,
	NULL AS BH_NE_QUADRANGLE_SECTION,
	NULL AS BH_NE_REMARK,
	NULL AS BH_NE_FOOTAGE_NORTH_SOUTH,
	NULL AS BH_NE_FOOTAGE_NORTH_SOUTH_START_LINE,
	NULL AS BH_NE_FOOTAGE_EAST_WEST,
	NULL AS BH_NE_FOOTAGE_EAST_WEST_START_LINE,
	NULL AS BH_NE_FOOTAGE_REFERENCE_NAME,
	NULL AS BH_DLS_LOCATION_TYPE,
	NULL AS BH_DLS_EVENT_SEQUENCE,
	NULL AS BH_DLS_LEGAL_SUBDIVISION,
	NULL AS BH_DLS_LOC_EXCEPTION,
	NULL AS BH_DLS_MERIDIAN,
	NULL AS BH_DLS_MERIDIAN_DIRECTION,
	NULL AS BH_DLS_RANGE,
	NULL AS BH_DLS_RANGE_MODIFIER,
	NULL AS BH_DLS_SECTION,
	NULL AS BH_DLS_TOWNSHIP,
	NULL AS BH_DLS_TOWNSHIP_MODIFIER,
	NULL AS BH_DLS_REMARK,
	NULL AS BH_DLS_SOURCE,
	NULL AS BH_FPS_LOCATION_TYPE,
	NULL AS BH_FPS_EXCEPTION,
	NULL AS BH_FPS_GRID,
	NULL AS BH_FPS_REMARK,
	NULL AS BH_FPS_SECTION,
	NULL AS BH_FPS_SOURCE,
	NULL AS BH_FPS_UNIT,
	NULL AS BH_NTS_LOCATION_TYPE,
	NULL AS BH_NTS_BLOCK,
	NULL AS BH_NTS_EVENT_SEQUENCE,
	NULL AS BH_NTS_LETTER_QUADRANGLE,
	NULL AS BH_NTS_LOC_EXCEPTION,
	NULL AS BH_NTS_PRIMARY_QUADRANGLE,
	NULL AS BH_NTS_QUARTER_UNIT,
	NULL AS BH_NTS_REMARK,
	NULL AS BH_NTS_SIXTEENTH,
	NULL AS BH_NTS_SOURCE,
	NULL AS BH_NTS_UNIT,
	ROW_NUMBER() OVER (PARTITION BY LEFT(wr.API14, 14) ORDER BY wr.UpdatedDate) AS WellRollupSequence
FROM
	StageDI.WellRollups wr WITH (NOLOCK)
LEFT JOIN
	StageDI.WellOrigins wo WITH (NOLOCK)
ON
	wr.API10 = wo.GovernmentID
WHERE
	wr.DeletedDate IS NULL OR wr.DeletedDate = '01/01/1900') wowr
WHERE
	WellRollupSequence = 1